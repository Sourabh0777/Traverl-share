{"ast":null,"code":"import _slicedToArray from\"/home/sourabh/Documents/0. Work/0. Project/MERN Stack/Client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useCallback,useEffect,useState}from\"react\";var logoutTimer;export var useAuth=function useAuth(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),token=_useState2[0],settoken=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),userId=_useState4[0],setuserId=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),tokenExpirationDate=_useState6[0],setTokenExpirationDate=_useState6[1];var login=useCallback(function(userId,token,expirationDate){settoken(token);var tokenExpirationDate=expirationDate||new Date(new Date().getTime()+1000*60*60);setTokenExpirationDate(tokenExpirationDate);localStorage.setItem(\"userData\",JSON.stringify({userId:userId,token:token,expiration:tokenExpirationDate.toISOString()}));setuserId(userId);},[]);var logout=useCallback(function(){settoken(null);setuserId(null);setTokenExpirationDate(null);localStorage.removeItem(\"userData\");},[]);useEffect(function(){if(token&&tokenExpirationDate){var remainingTime=tokenExpirationDate.getTime()-new Date().getTime();logoutTimer=setTimeout(logout,remainingTime);}else{clearTimeout(logoutTimer);}},[token,logout,tokenExpirationDate]);useEffect(function(){var storeData=JSON.parse(localStorage.getItem(\"userData\"));// Stored data isobject now\nif(storeData&&storeData.token&&new Date(storeData.expiration)>new Date()){login(storeData.userId,storeData.token,new Date(storeData.expiration));}},[login]);return{token:token,login:login,logout:logout,userId:userId};};","map":{"version":3,"names":["useCallback","useEffect","useState","logoutTimer","useAuth","_useState","_useState2","_slicedToArray","token","settoken","_useState3","_useState4","userId","setuserId","_useState5","_useState6","tokenExpirationDate","setTokenExpirationDate","login","expirationDate","Date","getTime","localStorage","setItem","JSON","stringify","expiration","toISOString","logout","removeItem","remainingTime","setTimeout","clearTimeout","storeData","parse","getItem"],"sources":["/home/sourabh/Documents/0. Work/0. Project/MERN Stack/Client/src/shared/hooks/auth-hook.js"],"sourcesContent":["import { useCallback, useEffect, useState } from \"react\";\nlet logoutTimer;\n\nexport const useAuth = () => {\n  const [token, settoken] = useState(false);\n  const [userId, setuserId] = useState();\n  const [tokenExpirationDate, setTokenExpirationDate] = useState();\n\n  const login = useCallback((userId, token, expirationDate) => {\n    settoken(token);\n    const tokenExpirationDate =\n      expirationDate || new Date(new Date().getTime() + 1000 * 60 * 60);\n    setTokenExpirationDate(tokenExpirationDate);\n    localStorage.setItem(\n      \"userData\",\n      JSON.stringify({\n        userId: userId,\n        token: token,\n        expiration: tokenExpirationDate.toISOString(),\n      })\n    );\n    setuserId(userId);\n  }, []);\n\n  const logout = useCallback(() => {\n    settoken(null);\n    setuserId(null);\n    setTokenExpirationDate(null);\n    localStorage.removeItem(\"userData\");\n  }, []);\n  useEffect(() => {\n    if (token && tokenExpirationDate) {\n      const remainingTime =\n        tokenExpirationDate.getTime() - new Date().getTime();\n      logoutTimer = setTimeout(logout, remainingTime);\n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, tokenExpirationDate]);\n  useEffect(() => {\n    const storeData = JSON.parse(localStorage.getItem(\"userData\")); // Stored data isobject now\n    if (\n      storeData &&\n      storeData.token &&\n      new Date(storeData.expiration) > new Date()\n    ) {\n      login(storeData.userId, storeData.token, new Date(storeData.expiration));\n    }\n  }, [login]);\n  return {token,login,logout,userId}\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}