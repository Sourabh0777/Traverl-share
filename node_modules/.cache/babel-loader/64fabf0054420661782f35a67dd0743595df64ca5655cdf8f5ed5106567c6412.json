{"ast":null,"code":"import _regeneratorRuntime from\"/home/sourabh/Documents/0. Work/0. Project/MERN Stack/Client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/sourabh/Documents/0. Work/0. Project/MERN Stack/Client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/sourabh/Documents/0. Work/0. Project/MERN Stack/Client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState,useContext}from\"react\";import{useParams}from\"react-router-dom\";import Input from\"../../shared/components/FormElements/Input\";import Button from\"../../shared/components/FormElements/Button\";import Card from\"../../shared/components/UIElements/Card\";import{VALIDATOR_REQUIRE,VALIDATOR_MINLENGTH}from\"../../shared/util/validators\";import{useForm}from\"../../shared/hooks/form-hook\";import\"./PlaceForm.css\";import{useHttpClient}from\"../../shared/hooks/http-hook\";import ErrorModal from\"../../shared/components/UIElements/ErrorModal\";import LoadingSpinner from\"../../shared/components/UIElements/LoadingSpinner\";import{useHistory}from\"react-router-dom/cjs/react-router-dom.min\";import{AuthContext}from\"../../shared/context/auth-context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UpdatePlace=function UpdatePlace(){var auth=useContext(AuthContext);var _useHttpClient=useHttpClient(),isLoading=_useHttpClient.isLoading,error=_useHttpClient.error,sendRequest=_useHttpClient.sendRequest,clearError=_useHttpClient.clearError;var _useState=useState(),_useState2=_slicedToArray(_useState,2),loadedPlace=_useState2[0],setloadedPlace=_useState2[1];var placeId=useParams().placeId;var history=useHistory();var _useForm=useForm({title:{value:\"\",isValid:false},description:{value:\"\",isValid:false}},false),_useForm2=_slicedToArray(_useForm,3),formState=_useForm2[0],inputHandler=_useForm2[1],setFormData=_useForm2[2];useEffect(function(){debugger;var fetchPlaces=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var responseData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return sendRequest(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/places/\").concat(placeId));case 3:responseData=_context.sent;setloadedPlace(responseData.place);console.log(\"working\");setFormData({title:{value:responseData.places.title,isValid:true},description:{value:responseData.places.description,isValid:true}},true);_context.next=11;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);case 11:case\"end\":return _context.stop();}},_callee,null,[[0,9]]);}));return function fetchPlaces(){return _ref.apply(this,arguments);};}();fetchPlaces();},[sendRequest,placeId,setFormData]);var placeUpdateSubmitHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(event){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:event.preventDefault();_context2.prev=1;_context2.next=4;return sendRequest(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/places/\").concat(placeId),\"PATCH\",JSON.stringify({title:formState.inputs.title.value,description:formState.inputs.description.value}),{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+auth.token});case 4:history.push(\"/\"+auth.userId+\"/places\");_context2.next=9;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](1);case 9:case\"end\":return _context2.stop();}},_callee2,null,[[1,7]]);}));return function placeUpdateSubmitHandler(_x){return _ref2.apply(this,arguments);};}();if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"center\",children:/*#__PURE__*/_jsx(LoadingSpinner,{asOverlay:true})});}if(!loadedPlace&&!error){return/*#__PURE__*/_jsx(\"div\",{className:\"center\",children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Could not find place!\"})})});}return/*#__PURE__*/_jsxs(React.Fragment,{children:[error&&/*#__PURE__*/_jsx(ErrorModal,{error:error,onClear:clearError}),!isLoading&&loadedPlace&&/*#__PURE__*/_jsxs(\"form\",{className:\"place-form\",onSubmit:placeUpdateSubmitHandler,children:[isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"center\"}),/*#__PURE__*/_jsx(Input,{id:\"title\",element:\"input\",type:\"text\",label:\"Title\",validators:[VALIDATOR_REQUIRE()],errorText:\"Please enter a valid title.\",onInput:inputHandler,initialValue:loadedPlace.title,initialValid:true}),/*#__PURE__*/_jsx(Input,{id:\"description\",element:\"textarea\",label:\"Description\",validators:[VALIDATOR_MINLENGTH(5)],errorText:\"Please enter a valid description (min. 5 characters).\",onInput:inputHandler,initialValue:loadedPlace.description,initialValid:true}),/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:!formState.isValid,children:\"UPDATE PLACE\"})]})]});};export default UpdatePlace;","map":{"version":3,"names":["React","useEffect","useState","useContext","useParams","Input","Button","Card","VALIDATOR_REQUIRE","VALIDATOR_MINLENGTH","useForm","useHttpClient","ErrorModal","LoadingSpinner","useHistory","AuthContext","jsx","_jsx","jsxs","_jsxs","UpdatePlace","auth","_useHttpClient","isLoading","error","sendRequest","clearError","_useState","_useState2","_slicedToArray","loadedPlace","setloadedPlace","placeId","history","_useForm","title","value","isValid","description","_useForm2","formState","inputHandler","setFormData","fetchPlaces","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","responseData","wrap","_callee$","_context","prev","next","concat","process","env","REACT_APP_BACKEND_URL","sent","place","console","log","places","t0","stop","apply","arguments","placeUpdateSubmitHandler","_ref2","_callee2","event","_callee2$","_context2","preventDefault","JSON","stringify","inputs","Authorization","token","push","userId","_x","className","children","asOverlay","Fragment","onClear","onSubmit","id","element","type","label","validators","errorText","onInput","initialValue","initialValid","disabled"],"sources":["/home/sourabh/Documents/0. Work/0. Project/MERN Stack/Client/src/places/pages/UpdatePlace.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport Input from \"../../shared/components/FormElements/Input\";\nimport Button from \"../../shared/components/FormElements/Button\";\nimport Card from \"../../shared/components/UIElements/Card\";\nimport {\n  VALIDATOR_REQUIRE,\n  VALIDATOR_MINLENGTH,\n} from \"../../shared/util/validators\";\nimport { useForm } from \"../../shared/hooks/form-hook\";\nimport \"./PlaceForm.css\";\nimport { useHttpClient } from \"../../shared/hooks/http-hook\";\nimport ErrorModal from \"../../shared/components/UIElements/ErrorModal\";\nimport LoadingSpinner from \"../../shared/components/UIElements/LoadingSpinner\";\nimport { useHistory } from \"react-router-dom/cjs/react-router-dom.min\";\nimport { AuthContext } from \"../../shared/context/auth-context\";\n\nconst UpdatePlace = () => {\n  const auth = useContext(AuthContext);\n  const { isLoading, error, sendRequest, clearError } = useHttpClient();\n  const [loadedPlace, setloadedPlace] = useState();\n  const placeId = useParams().placeId;\n  const history = useHistory();\n  const [formState, inputHandler, setFormData] = useForm(\n    {\n      title: {\n        value: \"\",\n        isValid: false,\n      },\n      description: {\n        value: \"\",\n        isValid: false,\n      },\n    },\n    false\n  );\n\n  useEffect(() => {\n    debugger;\n\n    const fetchPlaces = async () => {\n      try {\n        const responseData = await sendRequest(\n          `${process.env.REACT_APP_BACKEND_URL}/places/${placeId}`\n        );\n        setloadedPlace(responseData.place);\n        console.log(\"working\");\n\n        setFormData(\n          {\n            title: {\n              value: responseData.places.title,\n              isValid: true,\n            },\n            description: {\n              value: responseData.places.description,\n              isValid: true,\n            },\n          },\n          true\n        );\n      } catch (error) {}\n    };\n    fetchPlaces();\n  }, [sendRequest, placeId, setFormData]);\n\n  const placeUpdateSubmitHandler = async (event) => {\n    event.preventDefault();\n    try {\n      await sendRequest(\n        `${process.env.REACT_APP_BACKEND_URL}/places/${placeId}`,\n        \"PATCH\",\n        JSON.stringify({\n          title: formState.inputs.title.value,\n          description: formState.inputs.description.value,\n        }),\n        {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + auth.token,\n        }\n      );\n      history.push(\"/\" + auth.userId + \"/places\");\n    } catch (error) {}\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"center\">\n        <LoadingSpinner asOverlay />\n      </div>\n    );\n  }\n  if (!loadedPlace && !error) {\n    return (\n      <div className=\"center\">\n        <Card>\n          <h2>Could not find place!</h2>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <React.Fragment>\n      {error && <ErrorModal error={error} onClear={clearError} />}\n      {!isLoading && loadedPlace && (\n        <form className=\"place-form\" onSubmit={placeUpdateSubmitHandler}>\n          {isLoading && <div className=\"center\"></div>}\n\n          <Input\n            id=\"title\"\n            element=\"input\"\n            type=\"text\"\n            label=\"Title\"\n            validators={[VALIDATOR_REQUIRE()]}\n            errorText=\"Please enter a valid title.\"\n            onInput={inputHandler}\n            initialValue={loadedPlace.title}\n            initialValid={true}\n          />\n          <Input\n            id=\"description\"\n            element=\"textarea\"\n            label=\"Description\"\n            validators={[VALIDATOR_MINLENGTH(5)]}\n            errorText=\"Please enter a valid description (min. 5 characters).\"\n            onInput={inputHandler}\n            initialValue={loadedPlace.description}\n            initialValid={true}\n          />\n          <Button type=\"submit\" disabled={!formState.isValid}>\n            UPDATE PLACE\n          </Button>\n        </form>\n      )}\n    </React.Fragment>\n  );\n};\n\nexport default UpdatePlace;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}