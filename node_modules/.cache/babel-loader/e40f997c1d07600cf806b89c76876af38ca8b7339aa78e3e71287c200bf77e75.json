{"ast":null,"code":"import _regeneratorRuntime from\"/home/sourabh/Documents/0. Work/0. Project/MERN Stack/Client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/sourabh/Documents/0. Work/0. Project/MERN Stack/Client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/home/sourabh/Documents/0. Work/0. Project/MERN Stack/Client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/sourabh/Documents/0. Work/0. Project/MERN Stack/Client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useContext}from\"react\";import Card from\"../../shared/components/UIElements/Card\";import Input from\"../../shared/components/FormElements/Input\";import Button from\"../../shared/components/FormElements/Button\";import ErrorModal from\"../../shared/components/UIElements/ErrorModal\";import LoadingSpinner from\"../../shared/components/UIElements/LoadingSpinner\";import ImageUpload from\"../../shared/components/FormElements/ImageUpload\";import{VALIDATOR_EMAIL,VALIDATOR_MINLENGTH,VALIDATOR_REQUIRE}from\"../../shared/util/validators\";import{useForm}from\"../../shared/hooks/form-hook\";import{AuthContext}from\"../../shared/context/auth-context\";import\"./Auth.css\";import{useHttpClient}from\"../../shared/hooks/http-hook\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Auth=function Auth(){var auth=useContext(AuthContext);var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoginMode=_useState2[0],setIsLoginMode=_useState2[1];var _useHttpClient=useHttpClient(),isLoading=_useHttpClient.isLoading,error=_useHttpClient.error,sendRequest=_useHttpClient.sendRequest,clearError=_useHttpClient.clearError;var _useForm=useForm({email:{value:\"\",isValid:false},password:{value:\"\",isValid:false}},false),_useForm2=_slicedToArray(_useForm,3),formState=_useForm2[0],inputHandler=_useForm2[1],setFormData=_useForm2[2];var switchModeHandler=function switchModeHandler(){if(!isLoginMode){setFormData(_objectSpread(_objectSpread({},formState.inputs),{},{name:undefined,image:undefined}),formState.inputs.email.isValid&&formState.inputs.password.isValid);}else{setFormData(_objectSpread(_objectSpread({},formState.inputs),{},{name:{value:\"\",isValid:false},image:{value:null,isValid:false}}),false);}setIsLoginMode(function(prevMode){return!prevMode;});};var authSubmitHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var responseData,formData,_responseData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();if(!isLoginMode){_context.next=14;break;}_context.prev=2;_context.next=5;return sendRequest(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/users/login\"),\"POST\",JSON.stringify({email:formState.inputs.email.value,password:formState.inputs.password.value}),{\"Content-Type\":\"application/json\"});case 5:responseData=_context.sent;auth.login(responseData.userId,responseData.token);console.log(\"ðŸš€ ~ file: Auth.js:76 ~ authSubmitHandler ~ responseData.userId,responseData.token:\",responseData.userId,responseData.token);_context.next=12;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](2);case 12:_context.next=28;break;case 14:_context.prev=14;formData=new FormData();formData.append(\"email\",formState.inputs.email.value);formData.append(\"name\",formState.inputs.name.value);formData.append(\"password\",formState.inputs.password.value);formData.append(\"image\",formState.inputs.image.value);_context.next=22;return sendRequest(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/users/signup\"),\"POST\",formData);case 22:_responseData=_context.sent;auth.login(_responseData.userId,_responseData.token);_context.next=28;break;case 26:_context.prev=26;_context.t1=_context[\"catch\"](14);case 28:case\"end\":return _context.stop();}},_callee,null,[[2,10],[14,26]]);}));return function authSubmitHandler(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(React.Fragment,{children:[error&&/*#__PURE__*/_jsx(ErrorModal,{error:error,onClear:clearError}),/*#__PURE__*/_jsxs(Card,{className:\"authentication\",children:[isLoading&&/*#__PURE__*/_jsx(LoadingSpinner,{asOverlay:true}),/*#__PURE__*/_jsx(\"h2\",{children:\"Login Required\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:authSubmitHandler,children:[!isLoginMode&&/*#__PURE__*/_jsx(Input,{element:\"input\",id:\"name\",type:\"text\",label:\"Your Name\",validators:[VALIDATOR_REQUIRE()],errorText:\"Please enter a name.\",onInput:inputHandler}),!isLoginMode&&/*#__PURE__*/_jsx(ImageUpload,{center:true,id:\"image\",onInput:inputHandler,errorText:\"Please Provide an image.\"}),/*#__PURE__*/_jsx(Input,{element:\"input\",id:\"email\",type:\"email\",label:\"E-Mail\",validators:[VALIDATOR_EMAIL()],errorText:\"Please enter a valid email address.\",onInput:inputHandler}),/*#__PURE__*/_jsx(Input,{element:\"input\",id:\"password\",type:\"password\",label:\"Password\",validators:[VALIDATOR_MINLENGTH(6)],errorText:\"Please enter a valid password, at least 5 characters.\",onInput:inputHandler}),/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:!formState.isValid,children:isLoginMode?\"LOGIN\":\"SIGNUP\"})]}),/*#__PURE__*/_jsxs(Button,{inverse:true,onClick:switchModeHandler,children:[\"SWITCH TO \",isLoginMode?\"SIGNUP\":\"LOGIN\"]})]})]});};export default Auth;","map":{"version":3,"names":["React","useState","useContext","Card","Input","Button","ErrorModal","LoadingSpinner","ImageUpload","VALIDATOR_EMAIL","VALIDATOR_MINLENGTH","VALIDATOR_REQUIRE","useForm","AuthContext","useHttpClient","jsx","_jsx","jsxs","_jsxs","Auth","auth","_useState","_useState2","_slicedToArray","isLoginMode","setIsLoginMode","_useHttpClient","isLoading","error","sendRequest","clearError","_useForm","email","value","isValid","password","_useForm2","formState","inputHandler","setFormData","switchModeHandler","_objectSpread","inputs","name","undefined","image","prevMode","authSubmitHandler","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","responseData","formData","_responseData","wrap","_callee$","_context","prev","next","preventDefault","concat","process","env","REACT_APP_BACKEND_URL","JSON","stringify","sent","login","userId","token","console","log","t0","FormData","append","t1","stop","_x","apply","arguments","Fragment","children","onClear","className","asOverlay","onSubmit","element","id","type","label","validators","errorText","onInput","center","disabled","inverse","onClick"],"sources":["/home/sourabh/Documents/0. Work/0. Project/MERN Stack/Client/src/user/pages/Auth.js"],"sourcesContent":["import React, { useState, useContext } from \"react\";\n\nimport Card from \"../../shared/components/UIElements/Card\";\nimport Input from \"../../shared/components/FormElements/Input\";\nimport Button from \"../../shared/components/FormElements/Button\";\nimport ErrorModal from \"../../shared/components/UIElements/ErrorModal\";\nimport LoadingSpinner from \"../../shared/components/UIElements/LoadingSpinner\";\nimport ImageUpload from \"../../shared/components/FormElements/ImageUpload\";\n\nimport {\n  VALIDATOR_EMAIL,\n  VALIDATOR_MINLENGTH,\n  VALIDATOR_REQUIRE,\n} from \"../../shared/util/validators\";\nimport { useForm } from \"../../shared/hooks/form-hook\";\nimport { AuthContext } from \"../../shared/context/auth-context\";\nimport \"./Auth.css\";\nimport { useHttpClient } from \"../../shared/hooks/http-hook\";\nconst Auth = () => {\n  const auth = useContext(AuthContext);\n  const [isLoginMode, setIsLoginMode] = useState(true);\n\n  const { isLoading, error, sendRequest, clearError } = useHttpClient();\n\n  const [formState, inputHandler, setFormData] = useForm(\n    {\n      email: {\n        value: \"\",\n        isValid: false,\n      },\n      password: {\n        value: \"\",\n        isValid: false,\n      },\n    },\n    false\n  );\n\n  const switchModeHandler = () => {\n    if (!isLoginMode) {\n      setFormData(\n        {\n          ...formState.inputs,\n          name: undefined,\n          image: undefined,\n        },\n        formState.inputs.email.isValid && formState.inputs.password.isValid\n      );\n    } else {\n      setFormData(\n        {\n          ...formState.inputs,\n          name: {\n            value: \"\",\n            isValid: false,\n          },\n          image: { value: null, isValid: false },\n        },\n        false\n      );\n    }\n    setIsLoginMode((prevMode) => !prevMode);\n  };\n\n  const authSubmitHandler = async (event) => {\n    event.preventDefault();\n    if (isLoginMode) {\n      try {\n        const responseData = await sendRequest(\n          `${process.env.REACT_APP_BACKEND_URL}/users/login`,\n          \"POST\",\n          JSON.stringify({\n            email: formState.inputs.email.value,\n            password: formState.inputs.password.value,\n          }),\n          { \"Content-Type\": \"application/json\" }\n        );\n\n        auth.login(responseData.userId, responseData.token);\n        console.log(\n          \"ðŸš€ ~ file: Auth.js:76 ~ authSubmitHandler ~ responseData.userId,responseData.token:\",\n          responseData.userId,\n          responseData.token\n        );\n      } catch (error) {}\n    } else {\n      try {\n        const formData = new FormData();\n        formData.append(\"email\", formState.inputs.email.value);\n        formData.append(\"name\", formState.inputs.name.value);\n        formData.append(\"password\", formState.inputs.password.value);\n        formData.append(\"image\", formState.inputs.image.value);\n\n        const responseData = await sendRequest(\n          `${process.env.REACT_APP_BACKEND_URL}/users/signup`,\n          \"POST\",\n          formData\n        );\n        auth.login(responseData.userId, responseData.token);\n      } catch (error) {}\n    }\n  };\n  return (\n    <React.Fragment>\n      {error && <ErrorModal error={error} onClear={clearError} />}\n      <Card className=\"authentication\">\n        {isLoading && <LoadingSpinner asOverlay />}\n        <h2>Login Required</h2>\n        <hr />\n        <form onSubmit={authSubmitHandler}>\n          {!isLoginMode && (\n            <Input\n              element=\"input\"\n              id=\"name\"\n              type=\"text\"\n              label=\"Your Name\"\n              validators={[VALIDATOR_REQUIRE()]}\n              errorText=\"Please enter a name.\"\n              onInput={inputHandler}\n            />\n          )}\n          {!isLoginMode && (\n            <ImageUpload\n              center\n              id=\"image\"\n              onInput={inputHandler}\n              errorText=\"Please Provide an image.\"\n            />\n          )}\n          <Input\n            element=\"input\"\n            id=\"email\"\n            type=\"email\"\n            label=\"E-Mail\"\n            validators={[VALIDATOR_EMAIL()]}\n            errorText=\"Please enter a valid email address.\"\n            onInput={inputHandler}\n          />\n          <Input\n            element=\"input\"\n            id=\"password\"\n            type=\"password\"\n            label=\"Password\"\n            validators={[VALIDATOR_MINLENGTH(6)]}\n            errorText=\"Please enter a valid password, at least 5 characters.\"\n            onInput={inputHandler}\n          />\n          <Button type=\"submit\" disabled={!formState.isValid}>\n            {isLoginMode ? \"LOGIN\" : \"SIGNUP\"}\n          </Button>\n        </form>\n        <Button inverse onClick={switchModeHandler}>\n          SWITCH TO {isLoginMode ? \"SIGNUP\" : \"LOGIN\"}\n        </Button>\n      </Card>\n    </React.Fragment>\n  );\n};\n\nexport default Auth;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}